name: Deploy Slack Webhook (DEPRECATED - R4 VIOLATION)

# ========================================
# â›” DEPRECATED - DO NOT USE â›”
# ========================================
# This workflow violates R4 (CI-only deployments via Terraform).
# It uses `gcloud run services update` which bypasses Terraform state.
#
# MIGRATION REQUIRED:
# - Use `.github/workflows/terraform-prod.yml` instead
# - All Slack Bob infrastructure is managed via Terraform module:
#   `infra/terraform/modules/slack_bob_gateway/`
#
# This workflow is kept for reference only and will FAIL with instructions
# if triggered. It will be removed in Phase 25.
#
# See: 000-docs/164-AA-REPT-phase-24-slack-bob-ci-deploy-and-restore.md
# ========================================

on:
  # Disabled - triggers removed to prevent accidental use
  workflow_dispatch:
    inputs:
      environment:
        description: '[DEPRECATED] Use terraform-prod.yml instead'
        required: true
        default: 'production'
        type: choice
        options:
          - production
          - staging

permissions:
  contents: read
  id-token: write

env:
  PROJECT_ID: bobs-brain
  REGION: us-central1
  SERVICE_NAME: slack-webhook

jobs:
  deprecation-notice:
    runs-on: ubuntu-latest
    steps:
      - name: â›” Fail with Migration Instructions
        run: |
          echo "========================================" >&2
          echo "â›” DEPRECATED WORKFLOW - R4 VIOLATION â›”" >&2
          echo "========================================" >&2
          echo "" >&2
          echo "This workflow uses 'gcloud run services update' which:" >&2
          echo "  âŒ Violates R4 (CI-only deployments via Terraform)" >&2
          echo "  âŒ Bypasses Terraform state management" >&2
          echo "  âŒ Creates deployment drift" >&2
          echo "" >&2
          echo "REQUIRED MIGRATION:" >&2
          echo "  âœ… Use: .github/workflows/terraform-prod.yml" >&2
          echo "  âœ… Infrastructure: infra/terraform/modules/slack_bob_gateway/" >&2
          echo "  âœ… Configuration: infra/terraform/envs/prod.tfvars" >&2
          echo "" >&2
          echo "HOW TO DEPLOY SLACK BOB (R4-COMPLIANT):" >&2
          echo "  1. Update Terraform code in infra/terraform/" >&2
          echo "  2. Create PR to main branch" >&2
          echo "  3. terraform-prod.yml will run plan automatically" >&2
          echo "  4. After merge, trigger terraform-prod.yml with apply=true" >&2
          echo "" >&2
          echo "DOCUMENTATION:" >&2
          echo "  ðŸ“– 000-docs/164-AA-REPT-phase-24-slack-bob-ci-deploy-and-restore.md" >&2
          echo "  ðŸ“– CLAUDE.md (Slack Bob deployment checklist)" >&2
          echo "" >&2
          echo "This workflow will be removed in Phase 25." >&2
          echo "========================================" >&2
          exit 1

  # DEPRECATED JOBS BELOW - DO NOT USE
  # Kept for reference only - all steps will be skipped
  deploy:
    runs-on: ubuntu-latest
    if: false  # Never runs - workflow fails at deprecation-notice
    steps:
      - name: This step is deprecated and will not run
        run: echo "Deprecated"
